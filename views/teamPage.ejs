<%- include('partials/header') -%>
  <div class="container-fluid team-progress-container">
    <div class="container-fluid px-5">
      <div class="row g-4">

        <!-- LEFT SIDE - Team Progress -->
        <div class="col-lg-8 col-md-7">
          <div class="card shadow-lg border-0 team-card">
            <div class="text-center card-header team-card-header">
              <h2 class="mb-0 text-dark fw-bold">
                <i class="bi me-2"></i>Team Progress
              </h2>
            </div>
            <div class="card-body p-4">

              <!-- Group Name -->
              <div class="group-name-section">
                <h3 class="fw-bold mb-0 group-name-title">
                  <i class="bi me-2"></i>

                  <!-- replace with cluster from backend  -->
                    <!-- Need cluster Code // Name from backend  -->
                  <%= groupCode.GroupName %>
                </h3>
              </div>




               <!-- replace with cluster from backend  -->
                    <!-- Need username // wager placed from backend  -->
              <!-- Users and Progress Bars -->
              <% groupCode.users.forEach((user, index)=> { %>
                <div class="card user-card">
                  <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h5 class="mb-0 fw-bold text-white">
                        <%= user.name %>
                      </h5>
                      <span class="badge wager-badge">
                        $<%= user.wager %>
                      </span>
                    </div>


<!-- depending on how many taks? are put in and checked off progress bar is reliant on that info -->

                    <!-- Progress Bar -->
                    <div class="progress progress-container">
                      <div class="progress-bar progress-bar-animated progress-bar-gold" role="progressbar"
                        style="width: <%= user.progress %>%" aria-valuenow="<%= user.progress %>" aria-valuemin="0"
                        aria-valuemax="100">
                      </div>
                    </div>
                  </div>
                </div>
              <% }) %>
            </div>
          </div>
        </div>

        <!-- RIGHT SIDE - Timeline & Cash Jar -->
        <div class="col-lg-4 col-md-5">
          <div class="d-flex flex-column gap-4">

            <!-- ~~~~ TIME LIMIT/ TIME LINE ~~~~~~--->
             <!-- ~~~~ !!!!! NEED TO BE ABLE TO SET THE TIME LIMIT ON THIS PAGE!!!!!  ~~~~~~--->
            <!-- ~~~~ !!!!! WORK IN PROGRESS !!!!!  ~~~~~~--->
            
             <div class="card shadow-lg border-0 timeline-card">
              <div class="card-header py-4 text-center timeline-header">
                <h4 class="mb-0 text-dark fw-bold">
                  <i class="bi me-2"></i>Timeline
                </h4>
              </div>
              <div class="card-body text-center p-5">
                <div class="display-5 fw-bold mb-2 timeline-time">
                  <i class="bi me-2"></i><%= groupCode.groupTime %>
                </div>
               <h4 class="mb-0 fw-bold">Challenge Duration</h4>
              </div>
            </div>

            <!-- ~~~~~~CASH JAR DIV~~~~~~ -->
            <div class="card shadow-lg border-0 cash-jar-card">
              <div class="card-header text-center cash-jar-header">
                <h4 class="mb-0 fw-bold">
                  <i class="bi me-2"></i>Cash Jar
                </h4>
              </div>
              <div class="card-body text-center p-4">
                



                <div class="cash-card">
                  <!-- ~~~~~~~~CASH JAR IMG/GIF ON CLOUDINARY~~~~~~ -->

                  <img src="https://res.cloudinary.com/dphggnlyy/image/upload/v1765558274/Untitled_design_redefb.gif" class="jar-img" alt="Cash Jar">

                  
                   <div class="hover-jar">
                   <!-- Coins dropping into jar --> 
                     <!-- <div class="big-coins">
                      <div class="coin coin-1">游리</div>
                      <div class="coin coin-2">游리</div>
                      <div class="coin coin-3">游리</div>
                    </div>  -->

                    <!-- DYNAMIC USER LIST // PULLING USERS FROM GROUP , NAME ,AND WAGER AMOUNT-->
                    <div class="amount-list">
                      <% groupCode.users.forEach((user, index) => { %>
                        <div class="user-line" style="--delay:<%= index * 0.2 %>s;">
                          <span class="coin-small">游리</span>
                          <p><%= user.name %>: $<%= user.wager %></p>
                        </div>
                      <% }) %>
                    </div>
                  </div>
                </div>

                <!--~~~~~TOTAL AMOUNT AMOUNGST ALL USERS~~~~~~-->
                <div class="mt-4">
                  <h2 class="display-2 fw-bold mb-2 cash-jar-total">
                    $<%= cashJar.total %>
                  </h2>
                  <p class="mb-0 mt-3 fs-5 fw-bold cash-jar-label">Total Pot</p>
                </div>

              </div>
            </div>

          </div>
        </div>

      </div>
    </div>
  </div>




<!-- GIF Reload Script ON HOVER OVER -->
<!-- !!!!!BACKEND PLEASE REVIEW WHERE THIS GOES !!!! -->

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const jarImg = document.querySelector('.jar-img');
    
    if (jarImg) {
      // Reload GIF on hover
      jarImg.addEventListener('mouseenter', function() {
        const src = this.src.split('?')[0];
        this.src = src + '?t=' + new Date().getTime();
      });
      
      // Optional: Also reload on click
      jarImg.addEventListener('click', function() {
        const src = this.src.split('?')[0];
        this.src = src + '?t=' + new Date().getTime();
      });
    }
  });
</script>

<%- include('partials/footer') -%>
